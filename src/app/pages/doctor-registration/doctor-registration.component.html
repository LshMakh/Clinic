<!-- doctor-registration.component.html -->
<div class="registration">
  <h2 class="header">რეგისტრაცია</h2>
  
  <div *ngIf="errorMessage" class="error-alert">
      {{ errorMessage }}
  </div>
  
  <form [formGroup]="registerForm" (ngSubmit)="onRegister()">
      <div class="row1">
          <div class="input-container">
              <div class="input">
                  <label for="firstName">სახელი</label>
                  <input type="text" id="firstName" formControlName="firstName" placeholder="(მინიმუმ 2 სიმბოლო)">
                  <div *ngIf="registerForm.get('firstName')?.invalid && registerForm.get('firstName')?.touched" 
                       class="error-message">
                      სახელის ველის შევსება აუცილებელია
                  </div>
              </div>
          </div>
          <div class="input-container">
              <div class="input">
                  <label for="email">Email</label>
                  <div class="input-wrapper">
                      <input type="email" 
                             id="email" 
                             formControlName="email"
                             [class.is-pending]="email?.pending"
                             [class.is-invalid]="email?.errors && email?.touched">
                      <div class="spinner" *ngIf="email?.pending"></div>
                  </div>
                  <div class="error-messages">
                      <div *ngIf="email?.errors?.['required'] && email?.touched" 
                           class="error-message">
                          Email is required
                      </div>
                      <div *ngIf="email?.errors?.['email'] && email?.touched" 
                           class="error-message">
                          Please enter a valid email
                      </div>
                      <div *ngIf="email?.errors?.['emailExists']" 
                           class="error-message">
                          This email is already in use
                      </div>
                  </div>
              </div>
          </div>
          <div class="input-container">
              <div class="input">
                  <label for="personalNumber">პირადი ნომერი</label>
                  <input type="text" id="personalNumber" formControlName="personalNumber" placeholder="00000000000">
                  <div *ngIf="registerForm.get('personalNumber')?.invalid && registerForm.get('personalNumber')?.touched" 
                       class="error-message">
                      პირადი ნომრის ველის შევსება აუცილებელია
                  </div>
              </div>
          </div>
      </div>

      <div class="row2">
          <div class="input-container">
              <div class="input">
                  <label for="lastName">გვარი</label>
                  <input type="text" id="lastName" formControlName="lastName">
                  <div *ngIf="registerForm.get('lastName')?.invalid && registerForm.get('lastName')?.touched" 
                       class="error-message">
                      გვარის ველის შევსება აუცილებელია
                  </div>
              </div>
          </div>
          <div class="input-container">
            <div class="input">
                <label for="specialty">სპეციალობა</label>
                <select id="specialty" formControlName="specialty" 
                        class="form-control">
                    <option value="">აირჩიეთ სპეციალობა</option>
                    <option *ngFor="let specialty of specialties" 
                            [value]="specialty.name">
                        {{specialty.name}}
                    </option>
                </select>
                <div *ngIf="registerForm.get('specialty')?.invalid && registerForm.get('specialty')?.touched" 
                     class="error-message">
                    სპეციალობის არჩევა აუცილებელია
                </div>
            </div>
        </div>
          <div class="input-container">
              <div class="input">
                  <label for="password">პაროლი</label>
                  <input type="password" id="password" formControlName="password" placeholder="(მინიმუმ 8 სიმბოლო)">
                  <div *ngIf="registerForm.get('password')?.invalid && registerForm.get('password')?.touched" 
                       class="error-message">
                      პაროლის ველის შევსება აუცილებელია
                  </div>
              </div>
          </div>
      </div>

      <div class="row3">
        <div class="input-container">
          <div class="input">
              <label for="photo">ფოტო</label>
              <div class="file-upload-container">
                  <input type="file" 
                         id="photo" 
                         (change)="onPhotoSelected($event)"
                         accept="image/jpeg,image/png"
                         class="file-input">
                  
                  <!-- Photo preview -->
                  <div *ngIf="photoPreview" class="preview-container">
                      <img [src]="photoPreview" alt="Selected photo" class="photo-preview">
                  </div>
                  
                  <div class="file-info">
                      <span>Allowed: JPEG, PNG (max 5MB)</span>
                  </div>
              </div>
          </div>
      </div>

      <div class="input-container">
          <div class="input">
              <label for="cv">CV</label>
              <div class="file-upload-container">
                  <input type="file" 
                         id="cv" 
                         (change)="onCVSelected($event)"
                         accept="application/pdf"
                         class="file-input">
                  
                  <!-- CV filename display -->
                  <div *ngIf="cvFileName" class="file-name">
                      Selected: {{ cvFileName }}
                  </div>
                  
                  <div class="file-info">
                      <span>Allowed: PDF (max 10MB)</span>
                  </div>
              </div>
          </div>
      </div>
          </div>
  
          <button type="submit" class="btn" [disabled]="!registerForm.valid || isSubmitting">
              {{ isSubmitting ? 'მიმდინარეობს...' : 'რეგისტრაცია' }}
          </button>
      </form>
  </div>